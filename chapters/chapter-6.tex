\chapter{Conclusions} \label{ch:conclusions}
A generalized method for solving depletion and mass transport has been presented. This method is based on discretizing the spatially dependent variables on a finite volume mesh thus, converting the system of PDEs into a much large system of ODEs. The system of ODEs results in a transition matrix which houses coefficient of vastly different orders of magnitude. Because of this and prior research in depletion mathematics, exponential time differencing methods were chosen as the main integrator functions for the ODEs. At the heart of these methods is the computation of the exponential of a matrix. There are many different algorithms to compute this and 5 methods are chosen. Three are based on transforming the action of the matrix exponential on a vector into a complex integral using Cauchy's integral formula. These solvers are CRAM, Hyperbolic and Parabolic. Two are based on combining the scaling and squaring method with a variable order Pad\'e approximation. These solvers are Pad\'e-method 1 and Pad\'e-method 2. The last solver is based on combining a variable order Taylor series with the scaling and squaring method. This solver is called Taylor. In addition to these solvers, a number of classical integrator methods are also shown but not the main topic of the report. These include the implicit backwards differencing formula of order 1 - 6 and four explicit Rung-Kutta methods, Forward Euler, Midpoint, Kutta third order and Kutta fourth order. 

These matrix exponential solvers were chosen based on their popularity and the mathematical properties of the ODEs transition matrix. Methods based on Cauchys integral formula do not have accuracy requirements based on the matrix norm, but do on the placement of the eigenvalues. Specifically that the eigenvalues must be clustered in a region around the negative real axis. The series methods (Pad\'e and Taylor) do have the requirement that the matrix norm is small and is why they the algorithms are coupled with scaling and squaring to reduce this norm. 

Nuclear depletion calculations create isotopic reaction rate coefficients which vary vastly in order of magnitude. These arise from half lives ranging from millions of years to less than seconds, as well as neutron atomic reactions which also have vastly different reaction rates. The relative size of the coefficient along with the time integration sizes required results in a system with a large matrix norm. Previous research has indicated that the eigenvalues of depletion problems are clustered around the negative real axis. Looking at face value, this would cause one to likely chose the Cauchy methods for solving a purely depletion matrix. In molten salt reactors, the addition of mass transport operators causes the eigenvalues of the ODE matrix to have imaginary parts which are non-trivial, possibly reducing the accuracy of Cauchy solvers. 

The spatial dependence of the depleted isotopes vary based on diffusion and convection physics. The diffusion operator is second order, which is shown to have excellent convergence rates for the progression problems. The convection operator was chosen as a variable order method, allowing for the use of first order upwind differencing and a second order TVD scheme. Each convection method is implemented on a flux limiter function basis, with the first order upwind scheme holding diagonal coefficients in the transition matrix. The second order convection correction is housed as constant linear source terms which are explicitly calculated from the previous time step. Test show that these TVD schemes can work quite well with the exponential time differencing. There were however, stability issues which were shown in progression problem 3. These results lead to two conclusions. The first comes from the instability shown in just the Cauchy matrix exponential algorithms and not the series algorithms. This effect can be remedied by increasing the order of the method or by varying time step size and descritization size. 

The time integration component of each matrix exponential solver was tested against the neutron precursors, lumped depletion and 2D convection transport with depletion, the later two containing mass transport methods to a gas phase or a system wall. In the neutron precursor problem the Taylor solver out performed each of the other matrix exponential algorithms in both run time and accuracy. The CRAM, Hyperbolic and Pad\'e-method 2 solvers each also had high accuracy. Pad\'e-method 2 had a large run time requirement compared to the other two and both CRAM and the Hyperbolic solvers required the use of sub-stepping to reduce the errors to the same relative errors. The lumped depletion case study showed that while the Taylor solver might be good for low norm matrices with small time steps, a full depletion problem will greatly increase the run time required for the solver. Even though the Taylor solver achieves very high accuracy for these problems. The Hyperbolic and CRAM solvers both showed good accuracy and low run times even though sub-stepping was required. The Parabolic solver didn't quite show the same level of accuracy as the other two Cauchy solvers. Pad\'e-method 2 showed the same level of accuracy as the Parabolic solver but with an order of magnitude less in run time. Interestingly enough Pad\'e-method 1 showed some of the best results for the lumped depletion problems. Resulting in the lowest run time with the same order of accuracy as CRAM and Hyperbolic. The 2D transport case backed up the results previously shown in the lumped depletion case. While both CRAM and the Hyperbolic solvers showed high accuracy with sub-stepping, Pad\'e-method 1 had both the highest accuracy and lowest run time. The classical BDF solvers performed quite well in the selected depletion problems, often achieving the same order of accuracy as the matrix exponential methods. It should be noted that these results may be deceiving because of the choice of isotopes for the case studies. The selected isotopes only had a minimal half-life 20 minutes, which is quite high when considering the full list of radionuclides required in depletion calculations. When a larger selection of isotopes is include, the time step size required to achieve the level of accuracy seen with the matrix exponential methods might drastically increase their run times. 

Sub-stepping was used in the depletion cases studies to reduce the relative error for each of the Cauchy solvers. These solvers seem to be less accurate for isotopes with low concentrations. The way in which this sub-stepping method can be improved so that there is very little increase in run time. If coupled with an LU solver such as SuperLU, the symbolic decomposition of the matrix can be done only once, as a first step. The following sub-steps would only need to compute the numerical decomposition. Doing it in this way would greatly reduce the run time increase from sub-stepping. 

In summary, 5 different matrix exponential algorithms were presented for the purpose of solving depletion and mass transport in molten salt reactors. Previous studies have indicated that algorithms such as CRAM, Hyperbolic and Parabolic would not be accurate when the transition matrix contained non-trivial complex eigenvalues, this was found to be relatively not true. Even when these matrices do have complex eigenvalues that will degrade the solution, these can be reduced by implementing a sub-stepping method. Series methods such as Pad\'e, which were not considered viable solvers for depletion problems, are in fact quite good with these problems and show great promise with molten salt reactor depletion problems. Future work should involve a closer examination of the error in Cauchy methods which could possibly result in the creation of a generalized algorithm for solving the matrix exponential. 

